# Workflow to analyzing your tidy data {#dplyr-2}

![](https://img.shields.io/badge/document%20status-in%20progress-red?style=flat-square)

```{r, eval=TRUE, child="includes/preamble.Rmd"}
```

`r '<!-- '`

```{r}
knitr::opts_chunk$set(eval = FALSE)
```

Here we will cover the fourth block, "*Work with final data*" in Figure \@ref(fig:diagram-overview-4)

```{r diagram-overview-4, fig.cap="Section of the overall workflow we will be covering.", echo=FALSE}
diagram_overview(4)
```

Day 2 afternoon (13:15, end at 16:45 --- ~3.5 hrs, with one big break, one small one during exercise):

    - more on functions
        - debugging (print, stop)
        - using with tidyverse
    - saving data and summarizing final
        - load_all
        - across, where, tidyselect helpers
        
- deeper into dplyr
    - tidyselect helpers
    - across and where
    - regular expressions?
    - joins
    - Possible uses:
        - calculating mean
            - summarize across is numeric (select where is.numeric)
            - show off the ... here (like with na.rm)
            - Like for the RR or actigraph
        - Any time you think you would use a for loop, use this.
        
- debugging in functions
    - breaks in RStudio?
    - basics like print.
    
- creating functions
    - and when using tidyverse functions

    - Possible uses:
        - calculating mean from df
            - select only numeric (select where is.numeric)
            - show off the ... here (like with na.rm)
        - Run multiple models and extract only some information
        - Run models on re-sampled sets
        - Combining with parallel processing?
            - Don't get them to do this, just show it.
    - Show but don't get them to do: other versions of functions in purrr
    
    - Include some final dplyr summarizing of results of mmash
    
- Final exercise could be to do everything we've done but on `sleep.csv`
and `questionnaire.csv`
    
- slides afterward
    - Incorporate open and reproducible practices in coding

Post course?

## Code:

```{r}
library(vroom)
library(here)
library(dplyr)
user_1_rr_data %>% 
    group_by(day) %>% 
    summarize(across(inter_beat_interval_seconds, 
                     list(mean = mean, min = min, max = max)))

user_1_rr_data %>% 
    group_by(day) %>% 
    # functional programming
    summarize(across(inter_beat_interval_seconds, 
                     list(mean = mean, min = min, max = max, sd = sd)))

```


## Misc

What happened? We had an error. We've encountered a problem due to
"[non-standard evaluation]" (or NSE). NSE is very commonly used in most tidyverse
packages as well as throughout base R. It's one of the first things computer 
scientists complain about when they use R, because it is such a foreign thing
in other programming languages. But NSE is what allows you to use formulas (e.g.
`y ~ x + x2` in modelling) or allows you to type out `select(Gender, BMI)`. In
other programming languages, it would be `select("Gender", "BMI")`. It gives a lot
of flexibility to use for doing data analysis, but can give some headaches when
programming in R. So instead we have to use quotes instead and use the `_at()` 
combined with `vars()` version of dplyr functions. The tidyr functions `gather`
and `spread` don't require these changes.

[non-standard evaluation]: https://adv-r.had.co.nz/Computing-on-the-language.html


`r '-->'`
